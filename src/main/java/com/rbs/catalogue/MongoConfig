package com.rbs.catalogue;

import java.io.IOException;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.data.mongodb.MongoDbFactory;
import org.springframework.data.mongodb.core.MongoTemplate;
import org.springframework.data.mongodb.core.SimpleMongoDbFactory;

import com.mongodb.MongoClient;

//Configuration for "live" connections
@Configuration
public class MongoConfig {

 @Value("${OPENSHIFT_MONGO_DB_HOST}")
 private String mongoHost;

 @Value("${OPENSHIFT_MONGO_DB_PORT}")
 private String mongoPort;

 @Value("catalogue")
 private String mongoDatabase;

 @Bean(name="mongoClient")
 public MongoClient mongoClient() throws IOException {
     return new MongoClient(mongoHost, Integer.parseInt(mongoPort));
 }

 @Autowired
 @Bean(name="mongoDbFactory")
 public MongoDbFactory mongoDbFactory(MongoClient mongoClient) {
     return new SimpleMongoDbFactory(mongoClient, mongoDatabase);
 }

 @Autowired
 @Bean(name="mongoTemplate")
 public MongoTemplate mongoTemplate(MongoClient mongoClient) {
     return new MongoTemplate(mongoClient, mongoDatabase);
 }
}
